
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>chapter31 &raquo;</title>
	<meta name="author" content="Michael Sharman">

	
	<meta name="description" content="UPDATE 16th Nov 2010: I had some issues with the import which I noted in the first code example below Today I had to import csv into a single mysql &hellip;">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="chapter31 &raquo;" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	
</head>

<body>
	<header id="header" class="inner"><h1><a href="/">chapter31 &raquo;</a></h1>
<nav id="main-nav"><ul class="main-navigation">
  <li><a href="/about">about</a></li>
  <li><a href="https://github.com/michaelsharman/">projects</a></li>
  <li><a href="/shell-commands">shell</a></li>
  <li><a href="http://tools.chapter31.com/">tools</a></li>
</ul>
</nav>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><ul class="main-navigation">
  <li><a href="/about">about</a></li>
  <li><a href="https://github.com/michaelsharman/">projects</a></li>
  <li><a href="/shell-commands">shell</a></li>
  <li><a href="http://tools.chapter31.com/">tools</a></li>
</ul>
</div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="http://google.com/search" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:chapter31.com">
			</form>
		</div>
	</div>
</nav>
<nav id="sub-nav" class="alignright">
	<div class="social">
		
		
		
		<a class="twitter" href="http://twitter.com/michaelsharman" title="Twitter">Twitter</a>
		
		
		<a class="github" href="https://github.com/michaelsharman" title="GitHub">GitHub</a>
		
    
		
		
		
		
		
		<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
	</div>
	<form class="search" action="http://google.com/search" method="get">
		<input class="alignright" type="text" name="q" results="0">
		<input type="hidden" name="q" value="site:chapter31.com">
	</form>
</nav>

</header>
	
		

	
	<div id="content" class="inner">


    <article class="post">
	<h2 class="title">
		
		<a href="/2010/11/15/importing-a-csv-into-mysql-using-the-command-line/">
		
			Importing a Csv Into MySQL Using the Command Line</a>
	</h2>
	<div class="entry-content">
		<p><strong><em>UPDATE 16th Nov 2010: I had some issues with the import which I noted in the first code example below</em></strong></p>

<p>Today I had to import csv into a single mysql table. The destination table only had 5 columns and the csv was around 22MB (around 400,000 records). The csv also contained more columns that I needed for the import. Sometimes I&#8217;ll use a GUI to do this as I usually have one open, but it never ceases to amaze me how much slower GUI tools are compared to the command line.</p>

<p>To import the file via Aqua Data Studio took around 20 mins to import on my machine (over the network to the staging server took over 40mins!). As I need to do this more and more I though I&#8217;d look at a few command line options. I actually wanted to do this in 2 steps; firstly import the csv, them export it as a sql file and import it into &#8220;production&#8221; from there.</p>

<p>First we need to import the original .csv, ignoring certrain columns which the destination table didn&#8217;t need. Why not open this in excel/open office and <code>clean</code> the csv first? Too many rows, by default open office won&#8217;t read that many rows, plus it slows the machine down to even try that, double plus it&#8217;s super simple to ignore columns you don&#8217;t need:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">mysql</span><span class="o">&gt;</span> <span class="nx">LOAD</span> <span class="nx">DATA</span> <span class="nx">LOCAL</span> <span class="nx">INFILE</span> <span class="s1">&#39;/pathtofile/myfile.csv&#39;</span>
</span><span class='line'>    <span class="o">-&gt;</span> <span class="nx">INTO</span> <span class="nx">TABLE</span> <span class="nx">MyTable</span>
</span><span class='line'>    <span class="o">-&gt;</span> <span class="nx">FIELDS</span> <span class="nx">TERMINATED</span> <span class="nx">BY</span> <span class="s1">&#39;,&#39;</span>
</span><span class='line'>    <span class="o">-&gt;</span> <span class="nx">ENCLOSED</span> <span class="nx">BY</span> <span class="s1">&#39;&quot;&#39;</span>
</span><span class='line'>    <span class="o">-&gt;</span> <span class="nx">LINES</span> <span class="nx">TERMINATED</span> <span class="nx">BY</span> <span class="s1">&#39;\r\n&#39;</span>
</span><span class='line'>    <span class="o">-&gt;</span> <span class="p">(</span><span class="nx">col1</span><span class="p">,</span><span class="nx">col2</span><span class="p">,</span><span class="err">@</span><span class="nx">ignore</span><span class="p">,</span><span class="nx">col3</span><span class="p">,</span><span class="nx">col4</span><span class="p">,</span><span class="err">@</span><span class="nx">ignore</span><span class="p">,</span><span class="nx">col5</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>Note the LINES TERMINATED BY&#8230;you really need &#8216;\r\n&#8217;, especially if you .csv had been generated from a Windows machine! Otherwise your import will be kinda funky :(</p>

<p>Also note the ENCLOSED BY &#8216;&#8221;&#8217;, if you skip that option then any data in the .csv what was enclosed by double quotes (strings for eg) will actually import the double quotes into your database which is more than likely not what you want.</p>

<p>Note the <code>@ignore</code> user variables specified in the column list. Basically that&#8217;s saying that there are extra columns in the csv which I don&#8217;t want to import into the database. So by assigning the csv column to a user variable and not assigning the variable to an actual table column you effectively ignore it. You can call the user variable anything you want (prefixed with <code>@</code> of course). Calling it <code>@ignore</code> made sense to me.</p>

<p>Great now we have our data in the table, took about 2 seconds to run as opposed to 20min in the GUI tool :/</p>

<p>Then I had to quickly massage the data via sql as defined by the business rules as the original csv was <code>incomplete</code> in terms of the application requirements. After that was done I exported the table into a sql file:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">mysqldump</span> <span class="o">-</span><span class="nx">uroot</span> <span class="o">-</span><span class="nx">p</span> <span class="p">[</span><span class="nx">local_database_name</span><span class="p">]</span> <span class="p">[</span><span class="nx">table_to_export</span><span class="p">]</span> <span class="o">--</span><span class="nx">skip</span><span class="o">-</span><span class="nx">opt</span> <span class="o">--</span><span class="nx">compact</span> <span class="o">--</span><span class="nx">disable</span><span class="o">-</span><span class="nx">keys</span> <span class="o">--</span><span class="nx">extended</span><span class="o">-</span><span class="nx">insert</span> <span class="o">--</span><span class="nx">no</span><span class="o">-</span><span class="nx">create</span><span class="o">-</span><span class="nx">info</span> <span class="o">&gt;</span> <span class="nx">mytable</span><span class="p">.</span><span class="nx">sql</span>
</span></code></pre></td></tr></table></div></figure>


<p>The options used here skip things in the .sql file like CREATE TABLE etc. They also combine INSERTS and disable the keys to improve the speed of the import. Finally import the production ready sql into:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">mysql</span> <span class="o">-</span><span class="nx">uroot</span> <span class="o">-</span><span class="nx">p</span> <span class="p">[</span><span class="nx">production_database</span><span class="p">]</span> <span class="o">&lt;</span> <span class="nx">mytable</span><span class="p">.</span><span class="nx">sql</span>
</span></code></pre></td></tr></table></div></figure>


<p>Again, the point of this is pure performance. The speed difference is incredible, even on a local machine I don&#8217;t know why anyone would bother using GUI tools to import/export data unless you were working with tiny databases/tables.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2010-11-15T10:38:10+11:00" pubdate data-updated="true">Nov 15<span>th</span>, 2010</time></div>
	<div class="tags">


	<a class='category' href='/categories/databases/'>Databases</a>, <a class='category' href='/categories/mac/'>Mac</a>


</div>
	
		<div class="comments"><a href="/2010/11/15/importing-a-csv-into-mysql-using-the-command-line//page/5/index.html#disqus_thread">Comments</a></div>
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/2010/10/04/case-sensitive-development-on-mac-os-x/">
		
			Case Sensitive Development on Mac OS X</a>
	</h2>
	<div class="entry-content">
		<p><a href="http://www.learnosity.com/">At work</a> most of the developers are on Mac OS X but our staging and production environments are Linux based. This means development is case insensitive but stage/production is case sensitive. Although we have development guidelines/standards which dictate file and database naming conventions etc, human error can still occur (in terms of referencing files with a different &#8220;case&#8221;). We also use a few open source packages where we obviously don&#8217;t have control over the naming of files or the references to database tables within those files.</p>

<p>Why is this an issue?</p>

<p>Linux is a case sensitive environment, so calling <em>myClass.cfc</em> when the actual name of the file is <em>MyClass.cfc</em> will fail on Linux, but will be ok during development as Mac OS X isn&#8217;t case sensitive by default. The same would happen for MySQL table references in the codebase as tables are stored as files on the file system.</p>

<p>This has been an ongoing issue for us over the years particularly with open source libraries we may be using. So last week I decided to change my working environment to avoid finding these issues only once code had been deployed to staging. Overall the process was simple and really only took an hour or so (and most of that was waiting for files to copy across to the new location).</p>

<p>What I did was to create a case sensitive partition on the Mac and move my &#8220;Workspace&#8221; (project folders and files) and &#8220;MySQL&#8221; install to the new partition. Now any case sensitive issues will be found during development which is much preferable to finding them in staging/production :)</p>

<p>Setting up the new partition was done using <a href="http://www.coriolis-systems.com/iPartition.php">iPartition</a> but you could just as easily use the Disk Utility. I setup a new 50GB jhfsx partition (HFS Journaled case sensitive). Once that was done I copied my <em>workspace</em> folder across, then the <em>MySQL</em> folder. Finally, create symlinks for both the workspace and mysql paths so I didn&#8217;t run into any pathing issues in my apache conf etc.</p>

<p>Steps:</p>

<ol>
<li><p>Create your case sensitive <em>jhfsx (HFS Journaled case sensitive)</em> partition. 50GB was fine for me; your requirements may vary. Remember that you need enough space for your MySQL databases and your project files (both current and future).</p></li>
<li><p>Stop MySQL</p>

<blockquote><p>$ mysqladmin -uroot -p shutdown</p></blockquote></li>
<li><p>Copy the MySQL and Workspaces folders to the new paritition (I named my new partition &#8220;Learnosity&#8221;)</p>

<blockquote><p>$ sudo cp -rp /usr/local/mysql /Volumes/Learnosity
$ sudo cp -rp /users/michaelsharman/Workspaces /Volumes/Learnosity</p></blockquote></li>
<li><p>symlink your previous paths to the new partition to save you having to remap apache confs and MySQL commands etc</p>

<blockquote><p>$ sudo ln -sf /Volumes/Learnosity/mysql /usr/local/mysql
$ sudo ln -sf /Volumes/Learnosity/Workspaces /users/michaelsharman/Workspaces</p></blockquote></li>
<li><p>Set the MySQL <em>lower_case_table_names</em> to 0 (same as it is on Linux by default) by adding this line in /etc/my.cnf</p>

<blockquote><p>lower_case_table_names = 0</p></blockquote></li>
</ol>


<p>If you run <em>$ mysqladmin -uroot -p variables</em> you can see all global variables for your MySQL instance.</p>

<ol>
<li>Start MySQL

<blockquote><p>$ sudo mysqld -uroot</p></blockquote></li>
</ol>


<p>That should be it, don&#8217;t need to do anything else except change the location to your Workspaces folder in your editor of choice.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2010-10-04T22:36:00+11:00" pubdate data-updated="true">Oct 4<span>th</span>, 2010</time></div>
	<div class="tags">


	<a class='category' href='/categories/databases/'>Databases</a>, <a class='category' href='/categories/mac/'>Mac</a>


</div>
	
		<div class="comments"><a href="/2010/10/04/case-sensitive-development-on-mac-os-x//page/5/index.html#disqus_thread">Comments</a></div>
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/2010/09/08/tip-when-adding-allowmultiqueriestrue-to-your-mysql-dsn-in-coldfusion/">
		
			Tip When Adding &#8220;allowMultiQueries=true&#8221; to Your MySQL DSN in ColdFusion</a>
	</h2>
	<div class="entry-content">
		<p>Scenario&#8230;I&#8217;m using ColdFusion 9 and MySQL 5. I already had my DSN setup but had a requirement to get the last inserted id from a MySQL INSERT statement (I&#8217;m using auto-incrementing integer&#8217;s).</p>

<p>As most people know, the best way to do this (in MySQL) is using the <a href="http://dev.mysql.com/doc/refman/5.0/en/information-functions.html#function_last-insert-id">last_insert_id()</a> function. I wanted to attach this to the end of my INSERT statement for performance reasons, as I&#8217;d only be sending one query to the server instead of separate ones. Plus I&#8217;m not even sure if  I&#8217;d get the correct id back in a production environment if I sent it through as a separate query.</p>

<p>Anyway&#8230;for this to happen you need to add &#8220;allowMultiQueries=true&#8221; to your DSN connection string in ColdFusion Administrator (advanced settings) which I did. However I got an error when I tried to run the code, CF didn&#8217;t like me running 2 queries at once. Hmm&#8230;restarted CF which should have reloaded the drivers. No luck. Ok&#8230;how about restarting MySQL? Nope&#8230;</p>

<p>Finally took a comment from <a href="http://www.bennadel.com/blog/1209-Turning-On-Multiple-Statements-In-ColdFusion-8-MySQL-4-5-Datasource.htm">Will Tomlinson over on Ben Nadel&#8217;s blog</a> to help me out. Delete and recreate the DSN, happy days!</p>

<p><img src="/images/uploads/2010/09/cfadmin.png" alt="" /></p>

<p>Who want&#8217;s some sample code?</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="o">&lt;</span><span class="nx">cffunction</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;addStuff&quot;</span> <span class="nx">access</span><span class="o">=</span><span class="s2">&quot;public&quot;</span> <span class="nx">output</span><span class="o">=</span><span class="s2">&quot;false&quot;</span> <span class="nx">returnType</span><span class="o">=</span><span class="s2">&quot;numeric&quot;</span><span class="o">&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="nx">cfargument</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;ref&quot;</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;string&quot;</span> <span class="nx">required</span><span class="o">=</span><span class="s2">&quot;true&quot;</span><span class="o">&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="nx">cfargument</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;stage&quot;</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;string&quot;</span> <span class="nx">required</span><span class="o">=</span><span class="s2">&quot;true&quot;</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'>  <span class="o">&lt;</span><span class="nx">cfset</span> <span class="kd">var</span> <span class="nx">q</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'>  <span class="o">&lt;</span><span class="nx">cfquery</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;q&quot;</span> <span class="nx">datasource</span><span class="o">=</span><span class="s2">&quot;#variables.instance.config.dsn#&quot;</span><span class="o">&gt;</span>
</span><span class='line'>      <span class="nx">INSERT</span> <span class="nx">INTO</span> <span class="nx">mytable</span>
</span><span class='line'>          <span class="p">(</span>
</span><span class='line'>              <span class="nx">ref</span>
</span><span class='line'>              <span class="p">,</span> <span class="nx">stage</span>
</span><span class='line'>          <span class="p">)</span>
</span><span class='line'>      <span class="nx">VALUES</span>
</span><span class='line'>          <span class="p">(</span>
</span><span class='line'>              <span class="o">&lt;</span><span class="nx">cfqueryparam</span> <span class="nx">cfsqltype</span><span class="o">=</span><span class="s2">&quot;cf_sql_varchar&quot;</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&quot;#arguments.ref#&quot;</span><span class="o">&gt;</span>
</span><span class='line'>              <span class="p">,</span> <span class="o">&lt;</span><span class="nx">cfqueryparam</span> <span class="nx">cfsqltype</span><span class="o">=</span><span class="s2">&quot;cf_sql_varchar&quot;</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&quot;#arguments.stage#&quot;</span><span class="o">&gt;</span>
</span><span class='line'>          <span class="p">);</span><span class="nx">SELECT</span> <span class="nx">LAST_INSERT_ID</span><span class="p">()</span> <span class="nx">AS</span> <span class="nx">newId</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="err">/cfquery&gt;</span>
</span><span class='line'>
</span><span class='line'>  <span class="o">&lt;</span><span class="nx">cfreturn</span> <span class="nx">q</span><span class="p">.</span><span class="nx">newId</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="err">/cffunction&gt;</span>
</span></code></pre></td></tr></table></div></figure>


		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2010-09-08T22:47:00+10:00" pubdate data-updated="true">Sep 8<span>th</span>, 2010</time></div>
	<div class="tags">


	<a class='category' href='/categories/coldfusion/'>ColdFusion</a>, <a class='category' href='/categories/databases/'>Databases</a>


</div>
	
		<div class="comments"><a href="/2010/09/08/tip-when-adding-allowmultiqueriestrue-to-your-mysql-dsn-in-coldfusion//page/5/index.html#disqus_thread">Comments</a></div>
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/2010/05/27/cfml-issue-on-railo-with-the-accelerate-cache-tag/">
		
			CFML Issue on Railo With the Accelerate Cache Tag</a>
	</h2>
	<div class="entry-content">
		<p>We&#8217;ve been using <a href="http://www.bpurcell.org">Brandon Purcell&#8217;s</a> excellent accelerate custom cache tag for a few projects. I had an issue today while testing a new app which is about to go live. It seemed that whatever I did nothing would be cached.</p>

<p>Upon investigation it seemed that the caching worked fine on Adobe ColdFusion but not on Railo. A quick look at the codebase brought me to this line:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="o">&lt;</span><span class="nx">cfif</span> <span class="nx">IsDefined</span><span class="p">(</span><span class="s2">&quot;application.accelerator.#scriptName#.#primarykey#.#secondaryKey#&quot;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Basically this was always returning false, even when I knew the key was in the application scope. I changed it to the following:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="o">&lt;</span><span class="nx">cfif</span> <span class="nx">structKeyExists</span><span class="p">(</span><span class="nx">application</span><span class="p">,</span><span class="s2">&quot;accelerator[scriptName][primarykey][secondaryKey]&quot;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Success! (Thanks AJ for the final structKeyExists)</p>

<p>Just a quick fyi to anyone else who might be using this custom tag on Railo.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2010-05-27T16:30:30+10:00" pubdate data-updated="true">May 27<span>th</span>, 2010</time></div>
	<div class="tags">


	<a class='category' href='/categories/coldfusion/'>ColdFusion</a>, <a class='category' href='/categories/railo/'>Railo</a>


</div>
	
		<div class="comments"><a href="/2010/05/27/cfml-issue-on-railo-with-the-accelerate-cache-tag//page/5/index.html#disqus_thread">Comments</a></div>
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/2010/05/13/removing-duplicate-rows-in-open-office-calc/">
		
			Removing Duplicate Rows in Open Office (Calc)</a>
	</h2>
	<div class="entry-content">
		<p>I needed to de-dupe a spreadsheet the other day and <a href="http://blogs.sun.com/oootnt/entry/removing_duplicate_rows_in_calc">found a great how-to</a> from google. Thought I&#8217;d post it here for my own future purposes:</p>

<hr />

<p>There is no automatic function to remove duplicate rows. Follow these steps to delete all rows that have duplicate values in column A:</p>

<ol>
<li><p>Select all cells of the current data range.</p>

<p> On most systems, you can click any cell inside the data range, then press Ctrl+Multiplication key on the numeric keypad.</p></li>
<li><p>Sort the data range by column A.</p>

<p> Choose Data - Sort.</p></li>
<li><p>Click an empty cell in the first row. Let&#8217;s assume it is cell C1. Enter the formula:</p>

<p> =IF(A1=A2;1;0)</p>

<p> This will display 1 if the current row has the same value in column A as the next row. It will display 0 if the values are different.</p></li>
<li><p>Copy the formula down for all rows of the data range.</p>

<p> Drag the lower right edge of the cell C1 down to the last row.</p></li>
<li><p>Now the formulas must be replaced by their values to freeze the contents.</p>

<p> While the column C is still highlighted, press Ctrl+C to copy all selected cells to the clipboard.</p></li>
<li><p>Press Shift+Ctrl+V to open the Paste Special dialog box.</p>

<p> In the Selection area, enable only the Numbers command; disable the other Selection commands. Click OK.</p></li>
<li><p>Select the whole data range including the new column C and sort the range by column C.</p>

<p> Choose Data - Sort.</p></li>
<li><p>Select all rows which have a value 1 in column C, then press Del key.</p></li>
<li><p>Optional steps: Delete column C. Select the remaining rows and sort them again by column A.</p></li>
</ol>


		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2010-05-13T15:05:04+10:00" pubdate data-updated="true">May 13<span>th</span>, 2010</time></div>
	<div class="tags">


	<a class='category' href='/categories/coldfusion/'>ColdFusion</a>


</div>
	
		<div class="comments"><a href="/2010/05/13/removing-duplicate-rows-in-open-office-calc//page/5/index.html#disqus_thread">Comments</a></div>
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/2010/05/10/ie-and-underscores-in-domain-names/">
		
			IE and Underscores in Domain Names</a>
	</h2>
	<div class="entry-content">
		<p>Ok, a short warning to those who use underscores in their domain names. Underscores you say? Aren&#8217;t they illegal characters in domain names? Why yes they are (but I think they&#8217;re valid in sub-domains&#8230;not sure), but you may find yourself using them in development environments, particularly if you&#8217;re doing a re-design. Think something like <em>http://mysite_v2.local/</em> etc</p>

<p>Now, this works of course and everything is fine and dandy because your using your own hosts file to make it &#8220;legal&#8221;&#8230;except that Internet Explorer has this little quirk where it doesn&#8217;t persist your session (cookie) information. So your app sets some session variables, refresh the page and they&#8217;re gone. Sigh&#8230;</p>

<p>Why would IE even bother to do this? Who knows. But keep this in mind next time your pulling your hair out trying to figure out why session management isn&#8217;t working for you in IE.</p>

<p><strong>Rule:</strong></p>

<p>Don&#8217;t ever use underscores in domain names</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2010-05-10T09:09:27+10:00" pubdate data-updated="true">May 10<span>th</span>, 2010</time></div>
	<div class="tags">


	<a class='category' href='/categories/coldfusion/'>ColdFusion</a>, <a class='category' href='/categories/misc/'>Misc</a>


</div>
	
		<div class="comments"><a href="/2010/05/10/ie-and-underscores-in-domain-names//page/5/index.html#disqus_thread">Comments</a></div>
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/2010/04/22/support-details-tech-support-management/">
		
			Support Details - Tech Support Management</a>
	</h2>
	<div class="entry-content">
		<p>Ever dealt with a client where you wanted to know their operating environment? Thinks like what operating system they are running (and version), which browser type and version, whether they have JavaScript enabled etc? Sounds easy but for some clients this is like being asked to provide a detailed analysis of early 7th century rock formations around Stone Henge&#8230;in Latin. :(</p>

<p>Here&#8217;s a super simple solution that anyone could use :)</p>

<p><a href="http://supportdetails.com/">http://supportdetails.com/</a></p>

<p>Basically you send your client the URL above which they open. The web page will automatically detect their environment, all they have to do is enter your email address in a text box and click a button and in seconds you&#8217;ll receive an email detailing the system they are using. Nice!</p>

<p>If you want to make it even easier you can provide the URL to them with your email already attached:</p>

<p>E.g. http://supportdetails.com/?recipient=developer@mycompany.com</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2010-04-22T16:52:47+10:00" pubdate data-updated="true">Apr 22<span>nd</span>, 2010</time></div>
	<div class="tags">


	<a class='category' href='/categories/tools/'>Tools</a>


</div>
	
		<div class="comments"><a href="/2010/04/22/support-details-tech-support-management//page/5/index.html#disqus_thread">Comments</a></div>
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/2010/03/03/detecting-https-across-railo-and-coldfusion-server/">
		
			Detecting Https Across Railo and ColdFusion Server</a>
	</h2>
	<div class="entry-content">
		<p>Previously I had a way of <a href="http://www.chapter31.com/2007/07/21/detecting-and-redirecting-http-to-https/">detecting whether page requests were being made via ssl</a> but today I came across a scenario where this doesn&#8217;t work. Let me explain&#8230;</p>

<p>Right now we&#8217;re looking at developing across different ColdFusion engines, &#8220;ColdFusion&#8221; of course but also <a href="http://www.getrailo.com/">&#8220;Railo&#8221;</a>. One of the applications we had detected whether a request was being made securely (https) and if it wasn&#8217;t we turned off session management for security reasons. The basic code looked like the following snippet:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">oRequest</span> <span class="o">=</span> <span class="nx">getPageContext</span><span class="p">().</span><span class="nx">getRequest</span><span class="p">();</span>         
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="nx">oRequest</span><span class="p">.</span><span class="nx">isSecure</span><span class="p">())</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="k">this</span><span class="p">.</span><span class="nx">sessionManagement</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span><span class='line'>  <span class="k">this</span><span class="p">.</span><span class="nx">sessionTimeout</span> <span class="o">=</span> <span class="nx">createTimeSpan</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
</span><span class='line'>  <span class="k">this</span><span class="p">.</span><span class="nx">setClientCookies</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="k">else</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="k">this</span><span class="p">.</span><span class="nx">sessionManagement</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</span><span class='line'>  <span class="k">this</span><span class="p">.</span><span class="nx">setClientCookies</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>This was working all fine and dandy for ColdFusion Server, but was failing when we went to Railo (at least in the way we configure Railo). The reason was that we proxy page requests on Railo through Apache to Tomcat. This proxy is done over http regardless of the actual client request to the server. I guess the reason for this is that Apache to Tomcat is considered part of your secure (server) network. What was happening was that isSecure() was coming back false, because of this proxy request.</p>

<p><a href="http://www.lynchconsulting.com.au">Mark</a> came up with a cool solution for this. We simply add a custom header in the Apache conf file.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">RequestHeader</span> <span class="nx">set</span> <span class="nx">https</span> <span class="nx">on</span>
</span></code></pre></td></tr></table></div></figure>


<p>All this does is set a value into the header which we can pickup via the CGI scope, i.e. CGI.https</p>

<p>Now this key (https) already exists on ColdFusion server and will be blank for http requests and &#8220;on&#8221; for https requests. This is the reason we set the custom header value to &#8220;on&#8221; in the Railo vhost, so our application code is easily compatible across the two ColdFusion engines.</p>

<p>So now we just have a simple function to detect ssl requests:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="o">&lt;</span><span class="nx">cffunction</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;isRequestSecure&quot;</span> <span class="nx">access</span><span class="o">=</span><span class="s2">&quot;public&quot;</span> <span class="nx">output</span><span class="o">=</span><span class="s2">&quot;false&quot;</span> <span class="nx">returnType</span><span class="o">=</span><span class="s2">&quot;boolean&quot;</span><span class="o">&gt;</span>
</span><span class='line'>  
</span><span class='line'>  <span class="o">&lt;</span><span class="nx">cfset</span> <span class="kd">var</span> <span class="nx">secure</span> <span class="o">=</span> <span class="kc">false</span><span class="o">&gt;</span>
</span><span class='line'>      
</span><span class='line'>  <span class="o">&lt;</span><span class="nx">cfif</span> <span class="nx">cgi</span><span class="p">.</span><span class="nx">https</span> <span class="nx">EQ</span> <span class="s2">&quot;on&quot;</span><span class="o">&gt;</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="nx">cfset</span> <span class="nx">secure</span> <span class="o">=</span> <span class="kc">true</span><span class="o">&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="err">/cfif&gt;</span>
</span><span class='line'>      
</span><span class='line'>  <span class="o">&lt;</span><span class="nx">cfreturn</span> <span class="nx">secure</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="err">/cffunction&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now we can easily call isRequestSecure() which will be either true or false. Nice :)</p>

<p>Don&#8217;t forget that the CGI scope is kind of &#8220;magic&#8221;, in that we won&#8217;t ever need to param a key in that struct (like CGI.https).</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2010-03-03T14:14:56+11:00" pubdate data-updated="true">Mar 3<span>rd</span>, 2010</time></div>
	<div class="tags">


	<a class='category' href='/categories/coldfusion/'>ColdFusion</a>, <a class='category' href='/categories/railo/'>Railo</a>


</div>
	
		<div class="comments"><a href="/2010/03/03/detecting-https-across-railo-and-coldfusion-server//page/5/index.html#disqus_thread">Comments</a></div>
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/2010/01/20/cfhttp-issues-using-local-on-max-osx/">
		
			Cfhttp Issues Using &#8220;.local&#8221; on Max OSX</a>
	</h2>
	<div class="entry-content">
		<p>Ran into an interesting problem today doing something quite simple. Basically all I was doing was posting xml data to a URL, but I kept getting a 408 request timeout and I didn&#8217;t know why.</p>

<p>We happen to use the &#8220;.local&#8221; domain name structure for local development. I was posting data from one local site to another e.g.</p>

<p>http://mysite1.local   ->   http://mysite2.local</p>

<p>When I dumped cfhttp on the posting page I got the following error:</p>

<p><a href="/images/uploads/2010/01/cfhttp.png"><img src="/images/uploads/2010/01/cfhttp.png" alt="cfhttp" /></a></p>

<p>Now I hadn&#8217;t come across this error before with cfhttp and nothing I did fixed the issue, I even got that message using a &#8220;GET&#8221; method. It wasn&#8217;t till I tried &#8220;GET&#8221; from a public domain (http://www.google.com, which worked) that I thought to try a local domain which didn&#8217;t use &#8220;.local&#8221;.</p>

<p>Success!</p>

<p><a href="http://www.lynchconsulting.com.au/go/blog">Mark</a> mentioned that it could be a problem with Bonjour (as I&#8217;m on a Mac) which uses .local.</p>

<p>This is kinda timely as we&#8217;re moving away from the &#8220;.local&#8221; convention in favour of &#8220;.cf7&#8221;, &#8220;.cf9&#8221;, &#8220;.railo&#8221; etc as we&#8217;re using multiple cfmx engines for different projects and that provides a way to easily test codebases against different engines easily.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2010-01-20T10:28:00+11:00" pubdate data-updated="true">Jan 20<span>th</span>, 2010</time></div>
	<div class="tags">


	<a class='category' href='/categories/coldfusion/'>ColdFusion</a>


</div>
	
		<div class="comments"><a href="/2010/01/20/cfhttp-issues-using-local-on-max-osx//page/5/index.html#disqus_thread">Comments</a></div>
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/2009/10/30/browserlab-live-on-adobe-com/">
		
			BrowserLab Live on adobe.com</a>
	</h2>
	<div class="entry-content">
		<p>I&#8217;m probably a bit behind the times with this one, but Adobe have added &#8220;BrowserLab&#8221; functionality to &#8221;<em>preview and test your web pages on leading browsers and operating systems - on demand</em>&#8221;.</p>

<p>Seems to work like other paid services, but is free :)</p>

<p><a href="https://browserlab.adobe.com/">https://browserlab.adobe.com/</a></p>

<p>Available browser options (across mac and windows) include:</p>

<ul>
<li>IE 6/7/8</li>
<li>Firefox 2/3</li>
<li>Safari 3/4</li>
</ul>


<p><a href="/images/uploads/2009/10/Screen-shot-2009-10-30-at-11.58.48-AM.png"><img src="/images/uploads/2009/10/Screen-shot-2009-10-30-at-11.58.48-AM-300x166.png" alt="michaelsharman.com" /></a></p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2009-10-30T12:02:27+11:00" pubdate data-updated="true">Oct 30<span>th</span>, 2009</time></div>
	<div class="tags">


	<a class='category' href='/categories/misc/'>Misc</a>, <a class='category' href='/categories/tools/'>Tools</a>


</div>
	
		<div class="comments"><a href="/2009/10/30/browserlab-live-on-adobe-com//page/5/index.html#disqus_thread">Comments</a></div>
	
</div></article>

<nav id="pagenavi">
    
        <a href="/page/4/" class="prev">Prev</a>
    
    
        <a href="/page/6/" class="next">Next</a>
    
    <div class="center"><a href="/blog/archives">Blog Archives</a></div>
</nav></div>
	<footer id="footer" class="inner">Copyright &copy; 2013

    Michael Sharman

</footer>
	<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->


<script type="text/javascript">
      var disqus_shortname = 'chapter31';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-306772-2']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>



</body>
</html>


<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>chapter31 &raquo;</title>
	<meta name="author" content="Michael Sharman">

	
	<meta name="description" content="I&#8217;ve just upgraded to OSX Lion and had some trouble getting Apache to load a vhost. I kept getting a 403 permission denied error, but all my &hellip;">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="chapter31 &raquo;" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	
</head>

<body>
	<header id="header" class="inner"><h1><a href="/">chapter31 &raquo;</a></h1>
<nav id="main-nav"><ul class="main-navigation">
  <li><a href="/about">about</a></li>
  <li><a href="https://github.com/michaelsharman/">projects</a></li>
  <li><a href="/shell-commands">shell</a></li>
  <li><a href="http://tools.chapter31.com/">tools</a></li>
</ul>
</nav>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><ul class="main-navigation">
  <li><a href="/about">about</a></li>
  <li><a href="https://github.com/michaelsharman/">projects</a></li>
  <li><a href="/shell-commands">shell</a></li>
  <li><a href="http://tools.chapter31.com/">tools</a></li>
</ul>
</div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="http://google.com/search" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:chapter31.com">
			</form>
		</div>
	</div>
</nav>
<nav id="sub-nav" class="alignright">
	<div class="social">
		
		
		
		<a class="twitter" href="http://twitter.com/michaelsharman" title="Twitter">Twitter</a>
		
		
		<a class="github" href="https://github.com/michaelsharman" title="GitHub">GitHub</a>
		
    
		
		
		
		
		
		<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
	</div>
	<form class="search" action="http://google.com/search" method="get">
		<input class="alignright" type="text" name="q" results="0">
		<input type="hidden" name="q" value="site:chapter31.com">
	</form>
</nav>

</header>
	
		

	
	<div id="content" class="inner">


    <article class="post">
	<h2 class="title">
		
		<a href="/2012/06/05/apache-permission-denied-on-mac-osx-lion/">
		
			Apache Permission Denied on Mac OSX Lion</a>
	</h2>
	<div class="entry-content">
		<p>I&#8217;ve just upgraded to OSX Lion and had some trouble getting Apache to load a vhost. I kept getting a 403 permission denied error, but all my vhosts had the correct permission directives set.</p>

<p>Now by default your webserver document root is located in <em>/Library/WebServer/Documents</em>. I don&#8217;t really like that for my local machine, I&#8217;d rather store web files under my user account. Just tends to make things easier.</p>

<p>However&#8230;if you&#8217;re getting a 403 error, and something like this in your apache error log (/var/log/apache2/error_log):</p>

<pre><code>[Wed Jun 06 00:36:02 2012] [crit] [client 127.0.0.1] (13)Permission denied: /Users/[username]/Documents/.htaccess pcfg_openfile: unable to check htaccess file, ensure it is readable
</code></pre>

<p>Then check your directory permissions. The interesting thing is that I don&#8217;t have an .htaccess file in my Documents directory. Even adding one did nothing, so I&#8217;m not quite sure why Apache was complaining about this.</p>

<p>The answer was simple, I didn&#8217;t have &#8220;group&#8221; read or execute permissions on the <em>Documents</em> directory, once I ran a chmod&#8230;everything started working ok :)</p>

<pre><code>chmod 755 Documents
</code></pre>

<p>The actual path to my site was <em>/Users/[username]/Documents/workspaces/sitename/htdocs</em>, but still&#8230;without the requisite permissions on the <em>Documents</em> folder Apache couldn&#8217;t access the vhost.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2012-06-05T14:52:00+10:00" pubdate data-updated="true">Jun 5<span>th</span>, 2012</time></div>
	<div class="tags">


	<a class='category' href='/categories/apache-slash-iis/'>Apache/IIS</a>, <a class='category' href='/categories/mac/'>Mac</a>


</div>
	
		<div class="comments"><a href="/2012/06/05/apache-permission-denied-on-mac-osx-lion//page/3/index.html#disqus_thread">Comments</a></div>
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/2012/05/24/strange-linefeed-characters-appearing-on-mac/">
		
			Strange Linefeed Characters Appearing on Mac</a>
	</h2>
	<div class="entry-content">
		<p>Had a funny situation today where I was emailed a bash program file, but simply downloading the attachment from gmail (in Chrome) added a linefeed (\r) to the file.</p>

<p>This is strange because I never actually opened the file to edit, so I&#8217;m not sure what was writing those chars to the file. I&#8217;m on a Mac (OSX 10.6.8), so I get the line feed character in general, but just not in this case as the file was never opened.</p>

<p>The following command shows (among other things) the non-printing characters:</p>

<p><code>od -c filename | sed 4q</code></p>

<p><img src="/images/uploads/2012/05/dos2unix_before1.png" alt="" /></p>

<p>You can see the offending <em>\r</em> which was breaking the bash program. The unix tool <em>dos2unix</em> was suggested to clean up the file. Unfortunately this wasn&#8217;t available on Mac by default. MacPorts to the rescue (I assume homebrew would be a good option as well):</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo port install dos2unix
</span><span class='line'>Password:
</span><span class='line'>---&gt;  Fetching dos2unix
</span><span class='line'>---&gt;  Attempting to fetch dos2unix-3.1.tar.gz from http://fresh.t-systems-sfr.com/linux/src/
</span><span class='line'>---&gt;  Verifying checksum<span class="o">(</span>s<span class="o">)</span> <span class="k">for </span>dos2unix
</span><span class='line'>---&gt;  Extracting dos2unix
</span><span class='line'>---&gt;  Configuring dos2unix
</span><span class='line'>---&gt;  Building dos2unix with target all
</span><span class='line'>---&gt;  Staging dos2unix into destroot
</span><span class='line'>---&gt;  Installing dos2unix 3.1_0
</span><span class='line'>---&gt;  Activating dos2unix 3.1_0
</span><span class='line'>---&gt;  Cleaning dos2unix
</span></code></pre></td></tr></table></div></figure>


<p>Then run the program to clean up the invalid line feed (on 2 files).</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>dos2unix -n dirwatcher2 dirwatcher2_2
</span><span class='line'>dos2unix: converting file dirwatcher2 to file dirwatcher2_2 in UNIX format ...
</span><span class='line'>dos2unix -n processPDF processPDF_2
</span><span class='line'>dos2unix: converting file processPDF to file processPDF_2 in UNIX format ...
</span></code></pre></td></tr></table></div></figure>


<p>Nice! The changes are:</p>

<p><img src="/images/uploads/2012/05/dos2unix_after.png" alt="" /></p>

<p>No \r</p>

<p>:)</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2012-05-24T14:14:47+10:00" pubdate data-updated="true">May 24<span>th</span>, 2012</time></div>
	<div class="tags">


	<a class='category' href='/categories/mac/'>Mac</a>


</div>
	
		<div class="comments"><a href="/2012/05/24/strange-linefeed-characters-appearing-on-mac//page/3/index.html#disqus_thread">Comments</a></div>
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/2012/03/17/find-and-replace-with-line-breaks-in-eclipse/">
		
			Find and Replace With Line Breaks in Eclipse</a>
	</h2>
	<div class="entry-content">
		<p>Often with doing a find and replace you want to use line breaks in the find (or replace) criteria. Sometimes I&#8217;ll have a column of data from a csv that I want to modify&#8230;whatever.</p>

<p>You can now check the &#8220;regular expressions&#8221; checkbox while doing a file search in Eclipse and specify &#8220;\R&#8221; to find or replace line breaks (platform independent).</p>

<p>Eg replace line breaks with commas:</p>

<p><img src="/images/uploads/2012/03/Screen-shot-2012-03-17-at-1.54.41-PM.png" alt="" /></p>

<p>Other interesting and useful options are:</p>

<ul>
<li>\t - tabs</li>
<li>\n - newline</li>
<li>\R - platform indepedent line delimiter</li>
<li>\r - carriage return</li>
<li>^ - line start</li>
</ul>


<p>This was introduced in Eclipse 3.4.x, <a href="http://archive.eclipse.org/eclipse/downloads/drops/R-3.4-200806172000/whatsnew3.4/eclipse-news-part1.html">read more here</a>.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2012-03-17T13:56:45+11:00" pubdate data-updated="true">Mar 17<span>th</span>, 2012</time></div>
	<div class="tags">


	<a class='category' href='/categories/coldfusion/'>ColdFusion</a>


</div>
	
		<div class="comments"><a href="/2012/03/17/find-and-replace-with-line-breaks-in-eclipse//page/3/index.html#disqus_thread">Comments</a></div>
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/2012/03/15/error-restoring-mysql-database-when-using-btree-on-indexes/">
		
			Error Restoring MySQL Database When USING BTREE on Indexes</a>
	</h2>
	<div class="entry-content">
		<p>Occasionally when I&#8217;m restoring a database that was backed up from a different server than the one I&#8217;m restoring on I get an error along the lines of:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="o">&gt;</span><span class="p">[</span><span class="nb">Error</span><span class="p">]</span> <span class="nx">Script</span> <span class="nx">lines</span><span class="o">:</span> <span class="mi">5</span><span class="o">-</span><span class="mi">17</span> <span class="o">-------------------------</span>
</span><span class='line'> <span class="nx">You</span> <span class="nx">have</span> <span class="nx">an</span> <span class="nx">error</span> <span class="k">in</span> <span class="nx">your</span> <span class="nx">SQL</span> <span class="nx">syntax</span><span class="p">;</span> <span class="nx">check</span> <span class="nx">the</span> <span class="nx">manual</span> <span class="nx">that</span> <span class="nx">corresponds</span> <span class="nx">to</span> <span class="nx">your</span> <span class="nx">MySQL</span> <span class="nx">server</span> <span class="nx">version</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">right</span> <span class="nx">syntax</span> <span class="nx">to</span> <span class="nx">use</span> <span class="nx">near</span> <span class="s1">&#39;USING BTREE</span>
</span><span class='line'><span class="s1">) ENGINE=InnoDB DEFAULT CHARSET=utf8&#39;</span> <span class="nx">at</span> <span class="nx">line</span> <span class="mi">11</span>
</span><span class='line'>
</span><span class='line'> <span class="nx">Warnings</span><span class="o">:</span> <span class="o">---&gt;</span>
</span><span class='line'>   <span class="nx">W</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">:</span> <span class="nx">You</span> <span class="nx">have</span> <span class="nx">an</span> <span class="nx">error</span> <span class="k">in</span> <span class="nx">your</span> <span class="nx">SQL</span> <span class="nx">syntax</span><span class="p">;</span> <span class="nx">check</span> <span class="nx">the</span> <span class="nx">manual</span> <span class="nx">that</span> <span class="nx">corresponds</span> <span class="nx">to</span> <span class="nx">your</span> <span class="nx">MySQL</span> <span class="nx">server</span> <span class="nx">version</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">right</span> <span class="nx">syntax</span> <span class="nx">to</span> <span class="nx">use</span> <span class="nx">near</span> <span class="s1">&#39;USING BTREE</span>
</span><span class='line'><span class="s1">) ENGINE=InnoDB DEFAULT CHARSET=utf8&#39;</span> <span class="nx">at</span> <span class="nx">line</span> <span class="mi">11</span>
</span></code></pre></td></tr></table></div></figure>


<p>Hmm, the docs suggest that BTREE is a valid index type for both MyISAM and InnoDB. So why is it barfing?</p>

<p>Well it turns out dumping the database from a newer version of MySQL than what you are restoring onto can be bad. In my case running status at the mysql prompt told me that my source database was running on <em>5.5.9</em> but the destination version was <em>5.0.51a</em>.</p>

<p>Basically the issue seems to be that MySQL 5.0.x has issues with USING BTREE. So&#8230;just remove that from your sql and you&#8217;ll be good to go. Alternatively you can use the &#8211;compatible option when running your mysqldump on the <em>newer server version</em>, something like:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">mysqldump</span> <span class="o">--</span><span class="nx">compatible</span><span class="o">=</span><span class="nx">ansi</span> <span class="o">-</span><span class="nx">h127</span><span class="p">.</span><span class="mf">0.0</span><span class="p">.</span><span class="mi">1</span> <span class="o">-</span><span class="nx">umyuser</span> <span class="o">-</span><span class="nx">p</span> <span class="nx">mydatabase</span> <span class="o">|</span> <span class="nx">gzip</span> <span class="o">&gt;</span> <span class="nx">mydatabase</span><span class="p">.</span><span class="nx">sql</span><span class="p">.</span><span class="nx">gz</span>
</span></code></pre></td></tr></table></div></figure>


<p>The value of &#8220;compatible&#8221; can be ansi, mysql323, mysql40, postgresql, oracle, mssql, db2, maxdb, no_key_options, no_table_options, or no_field_options.</p>

<p>Nice</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2012-03-15T15:42:39+11:00" pubdate data-updated="true">Mar 15<span>th</span>, 2012</time></div>
	<div class="tags">


	<a class='category' href='/categories/databases/'>Databases</a>


</div>
	
		<div class="comments"><a href="/2012/03/15/error-restoring-mysql-database-when-using-btree-on-indexes//page/3/index.html#disqus_thread">Comments</a></div>
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/2012/03/14/turning-voice-over-off-permanently-on-max-osx/">
		
			Turning Voice Over Off Permanently on Max OSX</a>
	</h2>
	<div class="entry-content">
		<p>One of the keyboard shortcuts I often use is command-F6, but I seem to accidentally hit command-F5 on most occasions :(</p>

<p>Problem with this is that the god awful &#8220;voice over&#8221; starts yapping away. Well if you&#8217;re like me and know that you&#8217;ll pretty much never want this enabled (at least for now!) then here&#8217;s how you turn it off permanently.</p>

<ol>
<li>Open up system preferences</li>
<li>Click on keyboard</li>
<li>Go to the keyboard shortcuts tab</li>
<li>Choose universal access from the list on the left</li>
<li>Uncheck the &#8220;Turn voice over on or off&#8221; checkbox</li>
</ol>


<p>Breathe a sigh of relief :)</p>

<p><img src="/images/uploads/2012/03/sys_prefs.jpg" alt="mac system preferences" /></p>

<p><img src="/images/uploads/2012/03/voiceover_off.jpg" alt="Mac voice over off" /></p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2012-03-14T16:41:04+11:00" pubdate data-updated="true">Mar 14<span>th</span>, 2012</time></div>
	<div class="tags">


	<a class='category' href='/categories/mac/'>Mac</a>


</div>
	
		<div class="comments"><a href="/2012/03/14/turning-voice-over-off-permanently-on-max-osx//page/3/index.html#disqus_thread">Comments</a></div>
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/2011/10/27/twitter-bootstrap-modal-not-working-in-firefox/">
		
			Twitter Bootstrap - Modal Not Working in Firefox</a>
	</h2>
	<div class="entry-content">
		<p>Quick heads up for those having issues getting the modal window in the twitter bootstrap to work in firefox, I had a problem where the overlay would show but not the actual modal window content. Seems there is a problem if you&#8217;re using animation (fade etc).</p>

<p><a href="https://github.com/twitter/bootstrap/issues/240">See here for more information.</a></p>

<p>For now we use no animation, so a typical modal source example might be (note: no animation as is the default in the docs):</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="o">&lt;</span><span class="nx">div</span> <span class="nx">id</span><span class="o">=</span><span class="s2">&quot;preview-modal&quot;</span> <span class="kr">class</span><span class="o">=</span><span class="s2">&quot;modal hide&quot;</span><span class="o">&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="nx">div</span> <span class="kr">class</span><span class="o">=</span><span class="s2">&quot;modal-header&quot;</span><span class="o">&gt;</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s2">&quot;#&quot;</span> <span class="kr">class</span><span class="o">=</span><span class="s2">&quot;close&quot;</span><span class="o">&gt;&amp;</span><span class="nx">times</span><span class="p">;</span><span class="o">&lt;</span><span class="err">/a&gt;</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="nx">h3</span><span class="o">&gt;</span><span class="nx">Modal</span> <span class="nx">Heading</span><span class="o">&lt;</span><span class="err">/h3&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="err">/div&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="nx">div</span> <span class="kr">class</span><span class="o">=</span><span class="s2">&quot;modal-body&quot;</span><span class="o">&gt;</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="nx">One</span> <span class="nx">fine</span> <span class="nx">body</span><span class="err">…</span><span class="o">&lt;</span><span class="err">/p&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="err">/div&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="nx">div</span> <span class="kr">class</span><span class="o">=</span><span class="s2">&quot;modal-footer&quot;</span><span class="o">&gt;</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s2">&quot;#&quot;</span> <span class="kr">class</span><span class="o">=</span><span class="s2">&quot;btn primary&quot;</span><span class="o">&gt;</span><span class="nx">Primary</span><span class="o">&lt;</span><span class="err">/a&gt;</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s2">&quot;#&quot;</span> <span class="kr">class</span><span class="o">=</span><span class="s2">&quot;btn secondary&quot;</span><span class="o">&gt;</span><span class="nx">Secondary</span><span class="o">&lt;</span><span class="err">/a&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="err">/div&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="err">/div&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Typically there is &#8220;fade&#8221; in the class of the parent div which we&#8217;ve removed.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2011-10-27T18:00:45+11:00" pubdate data-updated="true">Oct 27<span>th</span>, 2011</time></div>
	<div class="tags">


	<a class='category' href='/categories/coldfusion/'>ColdFusion</a>


</div>
	
		<div class="comments"><a href="/2011/10/27/twitter-bootstrap-modal-not-working-in-firefox//page/3/index.html#disqus_thread">Comments</a></div>
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/2011/08/17/customising-search-results-from-google-cse/">
		
			Customising Search Results From Google Cse</a>
	</h2>
	<div class="entry-content">
		<p>Google custom search engine (cse) is pretty cool, in fact it&#8217;s very cool. Within minutes you can have the ability to search your entire site all with a snippet of code! And for a nominal fee you can deliver these results without ads :)</p>

<p>We use google cse for most of our sites but the other day we ran into a slight problem. The site in question has both public and private access, the public site is delivered over <em>http</em> and has plenty of indexable content. This is what we use google cse for. The issue came about once a user was logged in, their session is maintained via <em>secure cookies over https</em>. But the problem was that if they performed a search, all the results that cse returned directed users to <em>http</em> which effectively logged them out of the site (i.e. the user was no longer on https, as we don&#8217;t send cookies over http no session existed).</p>

<p>Even changing the site to index as <em>https</em> inside the cse control panel didn&#8217;t fix the issue, so we started to look for solutions to customise the results. Here are a few immediate options:</p>

<ul>
<li>Use the JSON API</li>
<li>Return the results as XML</li>
<li>Use custom templates</li>
</ul>


<p>The JSON API is super cool but from what I can see there&#8217;s a crazy limit of 150 queries per day unless you pay $5 per 1000 queries. Wow, no thanks.</p>

<p>XML is of course a tried and true approach but kinda clunky and verbose.</p>

<p>That leaves <a href="http://code.google.com/apis/customsearch/docs/js/rendering.html">custom templates</a>, from google:</p>

<blockquote><p>The specification that allows you to customize results is a minimal form of the template languages used by <a href="http://code.google.com/apis/opensocial/">OpenSocial</a> and <a href="http://code.google.com/apis/jstemplate/docs/howto.html">jstemplates</a>.</p></blockquote>

<p>This is a super cool and super easy way to modify the rendering of your custom google search results. Of course if you need to make big changes to the results then one of the other options is probably your best bet, but for what we wanted to achieve (delivering cse results as https) this was fine.</p>

<p>How does it work? Add your JavaScript snippet as usual:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="o">&lt;</span><span class="nx">script</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;text/javascript&quot;</span><span class="o">&gt;</span>
</span><span class='line'>  <span class="nx">google</span><span class="p">.</span><span class="nx">load</span><span class="p">(</span><span class="s1">&#39;search&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="p">{</span><span class="nx">language</span> <span class="o">:</span> <span class="s1">&#39;en&#39;</span><span class="p">,</span> <span class="s2">&quot;nocss&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">});</span>
</span><span class='line'>  <span class="nx">google</span><span class="p">.</span><span class="nx">setOnLoadCallback</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">customSearchControl</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">google</span><span class="p">.</span><span class="nx">search</span><span class="p">.</span><span class="nx">CustomSearchControl</span><span class="p">(</span><span class="s1">&#39;003499422247080460488:qvs6fhb5k8o&#39;</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">customSearchControl</span><span class="p">.</span><span class="nx">setResultSetSize</span><span class="p">(</span><span class="nx">google</span><span class="p">.</span><span class="nx">search</span><span class="p">.</span><span class="nx">Search</span><span class="p">.</span><span class="nx">FILTERED_CSE_RESULTSET</span><span class="p">);</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">google</span><span class="p">.</span><span class="nx">search</span><span class="p">.</span><span class="nx">DrawOptions</span><span class="p">();</span>
</span><span class='line'>      <span class="nx">options</span><span class="p">.</span><span class="nx">setAutoComplete</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">google</span><span class="p">.</span><span class="nx">search</span><span class="p">.</span><span class="nx">Csedr</span><span class="p">.</span><span class="nx">addOverride</span><span class="p">(</span><span class="s2">&quot;bos_&quot;</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">customSearchControl</span><span class="p">.</span><span class="nx">draw</span><span class="p">(</span><span class="s1">&#39;cse&#39;</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
</span><span class='line'>  <span class="p">},</span> <span class="kc">true</span><span class="p">);</span>
</span><span class='line'><span class="o">&lt;</span><span class="err">/script&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>We override the css from google and turn on autocomplete, apart from that the most important thing to note is the <em>addOverride()</em> option. Essentially here you add a prefix specific to your site, in this case ours is &#8220;bos_&#8221;. Google will look for this prefix, along with several specific values to render the content.</p>

<p>For example the main results appear in a section called <em>webResult</em>, so create a div with an id of your prefix + &#8220;webResult&#8221;</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="o">&lt;</span><span class="nx">div</span> <span class="nx">id</span><span class="o">=</span><span class="s2">&quot;bos_webResult&quot;</span><span class="o">&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>This is where google will look render the search results. A full example:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="o">&lt;</span><span class="nx">div</span> <span class="nx">id</span><span class="o">=</span><span class="s2">&quot;bos_webResult&quot;</span><span class="o">&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="nx">div</span> <span class="kr">class</span><span class="o">=</span><span class="s2">&quot;gs-webResult gs-result&quot;</span>
</span><span class='line'>  <span class="nx">data</span><span class="o">-</span><span class="nx">vars</span><span class="o">=</span><span class="s2">&quot;{longUrl:function() {</span>
</span><span class='line'><span class="s2">   var i = unescapedUrl.indexOf(visibleUrl);</span>
</span><span class='line'><span class="s2">   return i &lt; 1 ? visibleUrl : unescapedUrl.substring(i);}}&quot;</span><span class="o">&gt;</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="nx">table</span><span class="o">&gt;</span>
</span><span class='line'>          <span class="o">&lt;</span><span class="nx">tr</span><span class="o">&gt;</span>
</span><span class='line'>              <span class="o">&lt;</span><span class="nx">td</span> <span class="nx">valign</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="o">&gt;</span>
</span><span class='line'>                  <span class="o">&lt;</span><span class="nx">div</span> <span class="kr">class</span><span class="o">=</span><span class="s2">&quot;gs-title&quot;</span><span class="o">&gt;</span>
</span><span class='line'>                      <span class="o">&lt;</span><span class="nx">a</span> <span class="kr">class</span><span class="o">=</span><span class="s2">&quot;gs-title&quot;</span> <span class="nx">data</span><span class="o">-</span><span class="nx">attr</span><span class="o">=</span><span class="s2">&quot;{href:unescapedUrl.replace(&#39;http://&#39;, &#39;https://&#39;),target:target}&quot;</span> <span class="nx">data</span><span class="o">-</span><span class="nx">body</span><span class="o">=</span><span class="s2">&quot;html(title.replace(&#39;Our site tite :: &#39;, &#39;&#39;))&quot;</span><span class="o">&gt;&lt;</span><span class="err">/a&gt;</span>
</span><span class='line'>                  <span class="o">&lt;</span><span class="err">/div&gt;</span>
</span><span class='line'>                  <span class="o">&lt;</span><span class="nx">div</span> <span class="kr">class</span><span class="o">=</span><span class="s2">&quot;gs-snippet&quot;</span> <span class="nx">data</span><span class="o">-</span><span class="nx">body</span><span class="o">=</span><span class="s2">&quot;html(content)&quot;</span><span class="o">&gt;&lt;</span><span class="err">/div&gt;</span>
</span><span class='line'>                  <span class="o">&lt;</span><span class="nx">div</span> <span class="kr">class</span><span class="o">=</span><span class="s2">&quot;gs-visibleUrl gs-visibleUrl-long&quot;</span> <span class="nx">data</span><span class="o">-</span><span class="nx">body</span><span class="o">=</span><span class="s2">&quot;longUrl()&quot;</span><span class="o">&gt;&lt;</span><span class="err">/div&gt;</span>
</span><span class='line'>              <span class="o">&lt;</span><span class="err">/td&gt;</span>
</span><span class='line'>          <span class="o">&lt;</span><span class="err">/tr&gt;</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="err">/table&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="err">/div&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="err">/div&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>You can see that we&#8217;re using the template language &#8220;data-xxx&#8221; attributes on the &#8220;a&#8221; tag to modify the results returned from cse. In the example above we use the data-attr to replace &#8220;http://&#8221; with &#8220;https://&#8221; and also the data-body to replace the site title. This is possible because the templating approache evaluates JavaScript, nice!</p>

<p>There are many more options available with this approach, great to see google provide so many ways to render their search results.</p>

<p>This templating approach is another fantastic way to simplify the modifying the results from google cse. <a href="http://code.google.com/apis/customsearch/docs/js/rendering.html">Read more on their docs</a>.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2011-08-17T23:07:00+10:00" pubdate data-updated="true">Aug 17<span>th</span>, 2011</time></div>
	<div class="tags">


	<a class='category' href='/categories/coldfusion/'>ColdFusion</a>


</div>
	
		<div class="comments"><a href="/2011/08/17/customising-search-results-from-google-cse//page/3/index.html#disqus_thread">Comments</a></div>
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/2011/08/17/farcry-plugin-webtop-tools/">
		
			FarCry Plugin - Webtop Tools</a>
	</h2>
	<div class="entry-content">
		<p>We&#8217;re starting to compile a list of internal tools used when developing a FarCry application. I thought it might be simpler to create a small FarCry plugin to keep them all in the same place, makes it easier to use across multiple projects.</p>

<p><a href="https://github.com/michaelsharman/lcwebtoptools">The plugin</a> currently contains 2 scripts:</p>

<ul>
<li>FarCry database diff (MySQL only at this stage)</li>
<li>Content Object Meta</li>
</ul>


<p>The database diff looks for case-sensitivity differences between your ColdFusion components and the actual MySQL table names (MySQL only). Historically we&#8217;ve had issues because we are on Linux, this tool has helped quickly iron out any differences in &#8220;case&#8221;.</p>

<p>The Content Object Meta assists in finding information about content of any &#8220;type&#8221; in FarCry, based on the title, objectId or friendly URL. What does this mean? Well any &#8220;content object&#8221; you want information on can be found using this tool. Whether you have an objectId and you don&#8217;t know if it belongs to dmNavigation, dmHTML, dmNews or a custom type. Or you might have part of a friendly URL or content label/title. This tool can help tell you what the content type is, whether it&#8217;s approved, where it sits in the site tree (if relevant) etc.</p>

<p>For example; if I wanted to know everything in FarCry that had a label LIKE &#8216;credential&#8217; (wildcards are automatically added to your search term) I might get results like the following:</p>

<p><img src="/images/uploads/2011/08/contenttitle.png" alt="" /></p>

<p>From that initial resultset, if I clicked on an objectid for dmNavigation:</p>

<p><img src="/images/uploads/2011/08/objectid.png" alt="" /></p>

<p>Or if I clicked on an objectid for dmHTML:</p>

<p><img src="/images/uploads/2011/08/objectid_dmhtml.png" alt="" /></p>

<p>Note that there is a collapsed cfdump that you can expand for further info.</p>

<h2>Requirements</h2>

<p>Railo 3.2+ or ColdFusion 7+
FarCry 6+
MySQL 5+</p>

<h2>Installation</h2>

<p>&#8220;Official&#8221; notes on installing FarCry plugins can be found here: <a href="https://farcry.jira.com/wiki/pages/viewpage.action?pageId=12943398">https://farcry.jira.com/wiki/pages/viewpage.action?pageId=12943398</a></p>

<p>It&#8217;s pretty simple though:</p>

<ul>
<li>add the &#8220;lcwebtoptools&#8221; directory from git into /farcry/plugins/</li>
<li>add &#8220;lcwebtoptools&#8221; to THIS.plugins in farcryConstructor.cfm (in your project webroot)</li>
</ul>


<p>e.g.</p>

<pre><code>&lt;cfset THIS.plugins = "farcrycms,lcwebtoptools"&gt;
</code></pre>

<p>Restart your app, that&#8217;s it. No coapi changes need to be made. To access the current tools, go to the &#8220;Admin&#8221; tab and choose &#8220;Webtop Tools&#8221; from the drop down.</p>

<p>The plugin is <a href="https://github.com/michaelsharman/lcwebtoptools">hosted on github</a>, for a direct download to the zip <a href="https://github.com/michaelsharman/lcwebtoptools/zipball/master">click here</a>.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2011-08-17T10:38:33+10:00" pubdate data-updated="true">Aug 17<span>th</span>, 2011</time></div>
	<div class="tags">


	<a class='category' href='/categories/farcry/'>Farcry</a>


</div>
	
		<div class="comments"><a href="/2011/08/17/farcry-plugin-webtop-tools//page/3/index.html#disqus_thread">Comments</a></div>
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/2011/08/01/label-vs-title-in-farcry/">
		
			Label vs Title in FarCry</a>
	</h2>
	<div class="entry-content">
		<p>All system content objects (and those custom types which extend &#8220;types&#8221; or &#8220;versions&#8221; etc) in FarCry have the &#8220;label&#8221; and &#8220;title&#8221; properties. Most of the time the value of these are identical, I find myself typically using the &#8220;title&#8221; property in formtools as well as any display methods. The question of course is why have both these if they&#8217;re always exactly the same?</p>

<p>A note on the FarCry forums suggested that this was a handy way split what you might want to use in a display method vs an admin screen or any other scenario etc. Well today I had need to do exactly this, and combined with some of the custom metadata for your <em>type components</em> I&#8217;ve found that this is yet another simple but powerful feature of FarCry core.</p>

<h2>Scenario</h2>

<p>I have a custom type, a &#8220;topic&#8221;. Now these topics have titles but also &#8220;codes&#8221; associated with them. Sometimes I&#8217;ll want to output just the title, but sometimes I&#8217;ll want to output the code + title together. Sure <em>stObj</em> gives me the simple ability to access these singularly, but having the ability to store this composite value in the label field (as well as the single title in the &#8220;title&#8221; field) gives me freedom to display this in places like the object admin screen, generic nav, breadcrumbs etc. Very very nice.</p>

<h2>How</h2>

<p>Ok first you need to enable auto labels for your type:</p>

<pre><code>&lt;cfcomponent extends="farcry.core.packages.types.versions" displayname="ACE Topic" bUseInTree="0" bFriendly="1" fuAlias="acetopic" bObjectBroker="0" bAutoSetLabel="true"&gt;
</code></pre>

<p>Then for each property you&#8217;d like combined for your label, set a <em>bLabel</em> attribute to true.</p>

<pre><code>&lt;cfproperty name="Code" type="string" required="no" default="" ftSeq="1" ftwizardStep="Content" ftValidation="required" ftFieldset="General Details" bLabel="true"&gt;

&lt;cfproperty name="Title" type="string" hint="Title of content item." required="no" default="" ftSeq="2" ftwizardStep="Content" ftFieldset="General Details" ftValidation="required" bLabel="true"&gt;
</code></pre>

<p>What this now does (after you edit a content object) is save the &#8220;code + title&#8221; in the label field. Cool :)</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2011-08-01T09:16:01+10:00" pubdate data-updated="true">Aug 1<span>st</span>, 2011</time></div>
	<div class="tags">


	<a class='category' href='/categories/farcry/'>Farcry</a>


</div>
	
		<div class="comments"><a href="/2011/08/01/label-vs-title-in-farcry//page/3/index.html#disqus_thread">Comments</a></div>
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/2011/07/01/farcry-tip-enable-cfcs-in-your-railo-proxypassmatch/">
		
			FarCry Tip - Enable Cfc&#8217;s in Your Railo ProxyPassMatch</a>
	</h2>
	<div class="entry-content">
		<p>I ran into an issue today while working on a FarCry project, basically when I opened up the &#8220;Related Content&#8221; popup from the WYSIWYG editor it was blank. Nothing. Not the usual tabs for Images, File, Flash etc.</p>

<p><img src="/images/uploads/2011/07/relatedcontent.png" alt="" /></p>

<p>The Railo logs were empty but Apache was throwing a strange error which I hadn&#8217;t seen before: <em>&#8220;Couldn&#8217;t initialize from remote server, JRun server(s) probably down.&#8221;</em>. Funny as I&#8217;m not even using JRun!</p>

<p>Looking at the Chrome console I could see that opening the popup made a request directly to a cfc (/webtop/facade/tinyMCE.cfc?method=ajaxGetTemplateDropdowns) and returned the following error: &#8221;<em>Failed to load resource: the server responded with a status of 500 (Internal Server Error)</em>&#8221;</p>

<p>Eventually <a href="http://www.learnosity.com/techblog/">Mark</a> pointed me in the right direction which was kind of obvious if I&#8217;d actually read the error properly! Our config for Apache -> Railo is for cfm&#8217;s only&#8230;not cfc&#8217;s. I don&#8217;t really like the approach of calling cfc&#8217;s directly at all, which is why it&#8217;s not in our Apache -> Railo proxy. But it wasn&#8217;t a big deal to add it for FarCry projects.</p>

<p>Here is the config we now use, note we now pass requests for cfm and cfc to Railo:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'>    <span class="o">&lt;</span><span class="nx">IfModule</span> <span class="nx">mod_proxy_ajp</span><span class="p">.</span><span class="nx">c</span><span class="o">&gt;</span>
</span><span class='line'>            <span class="o">&lt;</span><span class="nx">Proxy</span> <span class="o">*&gt;</span>
</span><span class='line'>                    <span class="nx">Order</span> <span class="nx">deny</span><span class="p">,</span><span class="nx">allow</span>
</span><span class='line'>                    <span class="nx">Allow</span> <span class="nx">from</span> <span class="nx">all</span>
</span><span class='line'>            <span class="o">&lt;</span><span class="err">/Proxy&gt;</span>
</span><span class='line'>            <span class="nx">ProxyPassMatch</span> <span class="o">^</span><span class="sr">/(.*\.cf[cm])$ ajp:/</span><span class="o">/</span><span class="mf">127.0</span><span class="p">.</span><span class="mf">0.1</span><span class="o">:</span><span class="mi">8009</span><span class="o">/</span><span class="nx">$1</span>
</span><span class='line'>            <span class="nx">ProxyPassReverse</span>  <span class="o">/</span>  <span class="nx">ajp</span><span class="o">:</span><span class="c1">//127.0.0.1:8009/</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="err">/IfModule&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>And of course now the related content popup works :)</p>

<p><img src="/images/uploads/2011/07/relatedcontent2.png" alt="" /></p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2011-07-01T14:04:20+10:00" pubdate data-updated="true">Jul 1<span>st</span>, 2011</time></div>
	<div class="tags">


	<a class='category' href='/categories/farcry/'>Farcry</a>, <a class='category' href='/categories/railo/'>Railo</a>


</div>
	
		<div class="comments"><a href="/2011/07/01/farcry-tip-enable-cfcs-in-your-railo-proxypassmatch//page/3/index.html#disqus_thread">Comments</a></div>
	
</div></article>

<nav id="pagenavi">
    
        <a href="/page/2/" class="prev">Prev</a>
    
    
        <a href="/page/4/" class="next">Next</a>
    
    <div class="center"><a href="/blog/archives">Blog Archives</a></div>
</nav></div>
	<footer id="footer" class="inner">Copyright &copy; 2013

    Michael Sharman

</footer>
	<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->


<script type="text/javascript">
      var disqus_shortname = 'chapter31';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-306772-2']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>



</body>
</html>

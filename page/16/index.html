
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>chapter31 &raquo;</title>
	<meta name="author" content="Michael Sharman">

	
	<meta name="description" content="I just noticed this in the Adobe docs for cfqueryparam in ColdFusion 8: Revised 8/21/2007: Removed limitation on using the cfquery cachedAfter or &hellip;">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="chapter31 &raquo;" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	
</head>

<body>
	<header id="header" class="inner"><h1><a href="/">chapter31 &raquo;</a></h1>
<nav id="main-nav"><ul class="main-navigation">
  <li><a href="/about">about</a></li>
  <li><a href="https://github.com/michaelsharman/">projects</a></li>
  <li><a href="/shell-commands">shell</a></li>
  <li><a href="http://tools.chapter31.com/">tools</a></li>
</ul>
</nav>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><ul class="main-navigation">
  <li><a href="/about">about</a></li>
  <li><a href="https://github.com/michaelsharman/">projects</a></li>
  <li><a href="/shell-commands">shell</a></li>
  <li><a href="http://tools.chapter31.com/">tools</a></li>
</ul>
</div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="http://google.com/search" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:chapter31.com">
			</form>
		</div>
	</div>
</nav>
<nav id="sub-nav" class="alignright">
	<div class="social">
		
		
		
		<a class="twitter" href="http://twitter.com/michaelsharman" title="Twitter">Twitter</a>
		
		
		<a class="github" href="https://github.com/michaelsharman" title="GitHub">GitHub</a>
		
    
		
		
		
		
		
		<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
	</div>
	<form class="search" action="http://google.com/search" method="get">
		<input class="alignright" type="text" name="q" results="0">
		<input type="hidden" name="q" value="site:chapter31.com">
	</form>
</nav>

</header>
	
		

	
	<div id="content" class="inner">


    <article class="post">
	<h2 class="title">
		
		<a href="/2007/11/01/coldfusion-8-can-now-use-cacheaftercachewithin-when-using-cfqueryparams/">
		
			ColdFusion 8 Can Now Use cacheAfter/cacheWithin When Using Cfqueryparam&#8217;s</a>
	</h2>
	<div class="entry-content">
		<p>I just noticed this in the <a href="http://livedocs.adobe.com/coldfusion/8/htmldocs/help.html?content=Tags_p-q_18.html">Adobe docs</a> for cfqueryparam in ColdFusion 8:</p>

<blockquote><p>Revised 8/21/2007: Removed limitation on using the cfquery cachedAfter or cachedWithin attributes with cfqueryparam.This limit no longer applies.</p></blockquote>

<p>This is great news because before (MX7 and below):</p>

<blockquote><p>You cannot use the cfquery cachedAfter or cachedWithin attributes with cfqueryparam.</p></blockquote>

<p>I know many people didn&#8217;t like this limitation as it meant you needed to go to extra lengths to perform query caching (such as Application scope etc).</p>

<p>This is another reason why CF8 is so good :)</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2007-11-01T09:19:48+11:00" pubdate data-updated="true">Nov 1<span>st</span>, 2007</time></div>
	<div class="tags">


	<a class='category' href='/categories/coldfusion/'>ColdFusion</a>


</div>
	
		<div class="comments"><a href="/2007/11/01/coldfusion-8-can-now-use-cacheaftercachewithin-when-using-cfqueryparams//page/16/index.html#disqus_thread">Comments</a></div>
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/2007/10/18/styling-issues-when-generating-an-xls-from-html/">
		
			Styling Issues When Generating an Xls From HTML</a>
	</h2>
	<div class="entry-content">
		<p>A few notes to self on generating .xls files from HTML tables, particularly with CSS.</p>

<p>It appears that excel only has a particular &#8216;range&#8217; of hex numbers you can use (at least for background colours). I was trying to use #eeeeee; for a while (which is obviously fine for HTML and for creating a PDF), but I couldn&#8217;t use that as a value in excel as the colours just weren&#8217;t displaying. Perhaps the colour was too close to white?</p>

<p>In any event, once I chose a darker colour (#bbbbbb) the background colour appeared fine!</p>

<p>Another issue was that HTML allows you to specifiy multiple CSS classes such as:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="o">&lt;</span><span class="nx">table</span><span class="o">&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="nx">thead</span><span class="o">&gt;</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="nx">tr</span><span class="o">&gt;</span>
</span><span class='line'>          <span class="o">&lt;</span><span class="nx">th</span> <span class="kr">class</span><span class="o">=</span><span class="s2">&quot;sortOpt1 highlight&quot;</span><span class="o">&gt;</span><span class="nx">STUDIO</span><span class="o">&lt;</span><span class="err">/th&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>This wasn&#8217;t working for me, so for that <th> I added an inline style:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="o">&lt;</span><span class="nx">table</span><span class="o">&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="nx">thead</span><span class="o">&gt;</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="nx">tr</span><span class="o">&gt;</span>
</span><span class='line'>          <span class="o">&lt;</span><span class="nx">th</span> <span class="kr">class</span><span class="o">=</span><span class="s2">&quot;sortOpt1&quot;</span> <span class="nx">style</span><span class="o">=</span><span class="s2">&quot;background-color:##bbbbbb;&quot;</span><span class="o">&gt;</span><span class="nx">STUDIO</span><span class="o">&lt;</span><span class="err">/th&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>If anyone is interested in the code to actually launch the open/save dialogue window, here it is:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="o">&lt;</span><span class="nx">cfheader</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;Content-Disposition&quot;</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&quot;attachment; filename=studioDailyReport_#dateFormat(now(), &#39;yyyymmdd&#39;)#.xls&quot;</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="nx">cfcontent</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;application/msexcel&quot;</span><span class="o">&gt;</span>
</span><span class='line'><span class="c">&lt;!--</span><span class="o">-</span> <span class="nx">output</span> <span class="nx">HTML</span> <span class="nx">data</span> <span class="nx">here</span> <span class="o">---&gt;</span>
</span></code></pre></td></tr></table></div></figure>


		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2007-10-18T11:31:16+10:00" pubdate data-updated="true">Oct 18<span>th</span>, 2007</time></div>
	<div class="tags">


	<a class='category' href='/categories/coldfusion/'>ColdFusion</a>


</div>
	
		<div class="comments"><a href="/2007/10/18/styling-issues-when-generating-an-xls-from-html//page/16/index.html#disqus_thread">Comments</a></div>
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/2007/10/12/coldfusion-round-docs-inaccurate/">
		
			ColdFusion &#8216;Round()&#8217; Docs Inaccurate?</a>
	</h2>
	<div class="entry-content">
		<p>Today I needed a function which would return me a whole number, rounding either up or down depending on whether the value passed to the function was less than or greater than .5</p>

<p>Looking at <a href="http://livedocs.adobe.com/coldfusion/8/htmldocs/help.html?content=functions_m-r_40.html">round() ColdFusion 8 docs</a> they say:</p>

<blockquote><p>Rounds a number to the closest integer that is larger than the input parameter.</p></blockquote>

<p>Hmm, that doesn&#8217;t sound right.</p>

<p>In actual fact the round() function does exactly what it should, rounds numbers down OR up.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Round</span><span class="p">(</span><span class="mf">7.49</span><span class="p">)</span> <span class="o">=</span> <span class="mi">7</span>
</span><span class='line'><span class="nx">Round</span><span class="p">(</span><span class="mf">7.5</span><span class="p">)</span> <span class="o">=</span> <span class="mi">8</span>
</span><span class='line'><span class="nx">Round</span><span class="p">(</span><span class="mf">7.65</span><span class="p">)</span> <span class="o">=</span> <span class="mi">8</span>
</span><span class='line'><span class="nx">Round</span><span class="p">(</span><span class="o">-</span><span class="mf">7.49</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">7</span>
</span><span class='line'><span class="nx">Round</span><span class="p">(</span><span class="o">-</span><span class="mf">7.5</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">7</span>
</span><span class='line'><span class="nx">Round</span><span class="p">(</span><span class="o">-</span><span class="mf">7.65</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">8</span>
</span></code></pre></td></tr></table></div></figure>


<p>Also funny to note that although the docs site is much better for ColdFusion 8, many of the examples using ColdFusion variables are not parsed. So you get examples like #Round(7.49)#.</p>

<p>Hopefully Adobe will rectify this soon.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2007-10-12T15:26:01+10:00" pubdate data-updated="true">Oct 12<span>th</span>, 2007</time></div>
	<div class="tags">


	<a class='category' href='/categories/coldfusion/'>ColdFusion</a>


</div>
	
		<div class="comments"><a href="/2007/10/12/coldfusion-round-docs-inaccurate//page/16/index.html#disqus_thread">Comments</a></div>
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/2007/10/08/cant-set-a-scheduled-task-end-date/">
		
			Can&#8217;t Set a Scheduled Task &#8216;End Date&#8217;</a>
	</h2>
	<div class="entry-content">
		<p>I&#8217;ve just created some functionality which will be executed by a ColdFusion (8 standard on Win 2003) scheduled task daily, but only for 1 month.</p>

<p>When I add my new task in ColdFusion administrator I can set the &#8216;Start Date&#8217; ok, but not the &#8216;End Date&#8217;. The reason? Well I&#8217;m not sure, but it looks like a conflict in US/European date formats (I&#8217;m located in Australia and the server region settings are English/Australia).</p>

<p>Why oh why oh why oh why are there different date formats like mm/dd/yyyy and dd/mm/yyyy? Does this not annoy the HELL out of all developers out there who don&#8217;t reside in the US?</p>

<p>I want my task to begin on the 10th of October and end on the 7th of November. But try as I might I cannot enter the 7th of November as an end date in ColdFusion administrator, I keep getting either an invalid &#8216;End Date&#8217; format or that the end date is earlier than my start date.</p>

<p>Note that when you hover over the Start/End Date form fields the tooltip tells you the format should be entered as &#8216;mm/dd/yyyy&#8217;.</p>

<p>I&#8217;ve tried the following formats:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Start</span> <span class="nb">Date</span>     <span class="nx">End</span> <span class="nb">Date</span>
</span><span class='line'><span class="mi">10</span><span class="o">/</span><span class="mi">10</span><span class="o">/</span><span class="mi">2007</span>      <span class="mi">11</span><span class="o">/</span><span class="mi">07</span><span class="o">/</span><span class="mi">2007</span>
</span><span class='line'><span class="mi">10</span><span class="o">/</span><span class="mi">10</span><span class="o">/</span><span class="mi">2007</span>      <span class="mi">07</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="mi">2007</span>
</span><span class='line'><span class="mi">10</span><span class="o">/</span><span class="mi">10</span><span class="o">/</span><span class="mi">2007</span>      <span class="mi">11</span><span class="o">/</span><span class="mi">07</span><span class="o">/</span><span class="mi">2007</span>
</span><span class='line'><span class="mi">10</span><span class="o">/</span><span class="mi">10</span><span class="o">/</span><span class="mi">2007</span>      <span class="p">{</span><span class="nx">ts</span> <span class="s1">&#39;2007-07-11 00:00:00&#39;</span><span class="p">}</span>
</span><span class='line'><span class="mi">10</span><span class="o">/</span><span class="mi">10</span><span class="o">/</span><span class="mi">2007</span>      <span class="p">{</span><span class="nx">ts</span> <span class="s1">&#39;2007-11-07 00:00:00&#39;</span><span class="p">}</span>
</span><span class='line'><span class="mi">10</span><span class="o">/</span><span class="mi">10</span><span class="o">/</span><span class="mi">2007</span>      <span class="s1">&#39;07/November/2007&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>I can of course stop the code actually executing by checking the date etc then aborting, and then remove the task in ColdFusion administrator by hand. But, what am I doing wrong here? Has anyone else experienced this?</p>

<p>Thoughts?</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2007-10-08T15:06:12+10:00" pubdate data-updated="true">Oct 8<span>th</span>, 2007</time></div>
	<div class="tags">


	<a class='category' href='/categories/coldfusion/'>ColdFusion</a>


</div>
	
		<div class="comments"><a href="/2007/10/08/cant-set-a-scheduled-task-end-date//page/16/index.html#disqus_thread">Comments</a></div>
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/2007/10/05/createodbcdate-returns-time-as-well/">
		
			createODBCDate() Returns &#8216;Time&#8217; as Well?</a>
	</h2>
	<div class="entry-content">
		<p>Recently I was just comparing 2 dates (one from a query and the other was now()) using the <a href="http://livedocs.adobe.com/coldfusion/8/htmldocs/help.html?content=functions_c-d_19.html#1102341">createODBCDate()</a> and <a href="http://livedocs.adobe.com/coldfusion/8/htmldocs/help.html?content=functions_c-d_26.html">dateCompare()</a> functions.</p>

<p>I was using the createODBCDate() function because I only wanted the &#8216;date&#8217; part of a date object, not the &#8216;time&#8217;. More than likely I should have been using <a href="http://livedocs.adobe.com/coldfusion/8/htmldocs/help.html?content=functions-pt0_05.html#1098968">dateFormat()</a>, but that&#8217;s another story :)</p>

<p>I had the following:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="o">&lt;</span><span class="nx">cfif</span> <span class="nx">dateCompare</span><span class="p">(</span><span class="nx">createODBCDate</span><span class="p">(</span><span class="nx">q</span><span class="p">.</span><span class="nx">DateTimeCreated</span><span class="p">),</span> <span class="nx">createODBCDate</span><span class="p">(</span><span class="nx">now</span><span class="p">()))</span> <span class="nx">EQ</span> <span class="mi">0</span><span class="o">&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>The problem was I kept getting -1 returned, meaning that &#8216;q.DateTimeCreated&#8217; was less than &#8216;now()&#8217;. As &#8216;q.DateTimeCreated&#8217; was technically created before &#8216;now()&#8217; (same day but an earlier &#8216;time&#8217;) it <strong>is</strong> actually <em>less than</em>, but I only wanted to compare the date&#8230;not the time. When I dumped both date objects I got:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="p">{</span><span class="nx">d</span> <span class="s1">&#39;2007-10-05&#39;</span><span class="p">}</span>
</span><span class='line'><span class="p">{</span><span class="nx">d</span> <span class="s1">&#39;2007-10-05&#39;</span><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Looks the same to me&#8230;</p>

<p>I <em>think</em> that those date objects actually have the &#8216;time&#8217; in them as well, they&#8217;re just not being displayed on cfdump or cfoutput. This seems strange especially considering there is a createODBCDateTime() function as well.</p>

<p>My fix was to do what I probably should have done in the first place; use dateFormat()</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="o">&lt;</span><span class="nx">cfif</span> <span class="nx">dateCompare</span><span class="p">(</span><span class="nx">dateFormat</span><span class="p">(</span><span class="nx">q</span><span class="p">.</span><span class="nx">DateTimeCreated</span><span class="p">),</span> <span class="nx">dateFormat</span><span class="p">(</span><span class="nx">now</span><span class="p">()))</span> <span class="nx">EQ</span> <span class="mi">0</span><span class="o">&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>That did the trick!</p>

<p>Now the only thing bothering me is whether the createODBCDate() function actually <em>does</em> return the &#8216;time&#8217; as well&#8230;or was something else the culprit?</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2007-10-05T15:30:28+10:00" pubdate data-updated="true">Oct 5<span>th</span>, 2007</time></div>
	<div class="tags">


	<a class='category' href='/categories/coldfusion/'>ColdFusion</a>


</div>
	
		<div class="comments"><a href="/2007/10/05/createodbcdate-returns-time-as-well//page/16/index.html#disqus_thread">Comments</a></div>
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/2007/09/28/caveat-when-calling-components-from-onsessionend/">
		
			Caveat When Calling Components From onSessionEnd()</a>
	</h2>
	<div class="entry-content">
		<p>As most ColdFusion developers know, you cannot reference &#8216;application&#8217; scoped variables directly in Application.cfc&#8217;s <em>onSessionEnd()</em> method. Instead you need to use the <em>ApplicationScope</em> parameter. <a href="http://livedocs.adobe.com/coldfusion/8/htmldocs/help.html?content=AppEvents_11.html">Notes from the docs</a>:</p>

<blockquote><p>You must use the <em>ApplicationScope</em> parameter to access the Application scope. You cannot reference the Application scope directly; for example, use Arguments.ApplicationScope.myVariable, not Application.myVariable. Use a named lock when you reference variables in the Application scope, as shown in the example.</p></blockquote>

<p>I ran into this today when working on some code a colleague wrote which was firing a method in an application scoped component, the code was as follows:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="o">&lt;</span><span class="nx">cffunction</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;onSessionEnd&quot;</span> <span class="nx">output</span><span class="o">=</span><span class="s2">&quot;false&quot;</span> <span class="nx">returnType</span><span class="o">=</span><span class="s2">&quot;void&quot;</span><span class="o">&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="nx">cfargument</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;SessionScope&quot;</span> <span class="nx">required</span><span class="o">=</span><span class="s2">&quot;true&quot;</span> <span class="o">/&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="nx">cfargument</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;AppScope&quot;</span> <span class="nx">required</span><span class="o">=</span><span class="s2">&quot;true&quot;</span> <span class="o">/&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="nx">cfscript</span><span class="o">&gt;</span>
</span><span class='line'>      <span class="nx">arguments</span><span class="p">.</span><span class="nx">AppScope</span><span class="p">.</span><span class="nx">myCFC</span><span class="p">(</span><span class="nx">arg</span><span class="o">=</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">SessionScope</span><span class="p">.</span><span class="nx">arg</span><span class="p">);</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="err">/cfscript&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="err">/cffunction&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Obviously this method is being executed when the users session has expired. The use of <em>arguments.AppScope</em> means I can access the &#8216;myCFC&#8217; component which is stored in application scope.</p>

<p>Now to the actual problem&#8230;inside the cfc was a method which was logging information in the database, but the <em>datasource</em> value was coming from application scope.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="o">&lt;</span><span class="nx">cfquery</span> <span class="nx">datasource</span><span class="o">=</span><span class="s2">&quot;#application.dsn#&quot;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;qInsert&quot;</span><span class="o">&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Obviously arguments should be passed to components instead of being accessed directly, but that&#8217;s another story :)</p>

<p>I would have thought this would work fine, but no luck. It was a little bit of a pain to debug as you can&#8217;t see the results of onSessionEnd() being run.</p>

<p>The fix was simply to pass in the required variables as arguments to the method:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="o">&lt;</span><span class="nx">cffunction</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;onSessionEnd&quot;</span> <span class="nx">output</span><span class="o">=</span><span class="s2">&quot;false&quot;</span> <span class="nx">returnType</span><span class="o">=</span><span class="s2">&quot;void&quot;</span><span class="o">&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="nx">cfargument</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;SessionScope&quot;</span> <span class="nx">required</span><span class="o">=</span><span class="s2">&quot;true&quot;</span> <span class="o">/&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="nx">cfargument</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;AppScope&quot;</span> <span class="nx">required</span><span class="o">=</span><span class="s2">&quot;true&quot;</span> <span class="o">/&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="nx">cfscript</span><span class="o">&gt;</span>
</span><span class='line'>      <span class="nx">arguments</span><span class="p">.</span><span class="nx">AppScope</span><span class="p">.</span><span class="nx">myCFC</span><span class="p">(</span><span class="nx">arg</span><span class="o">=</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">SessionScope</span><span class="p">.</span><span class="nx">arg</span><span class="p">,</span><span class="nx">dsn</span><span class="o">=</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">Appscope</span><span class="p">.</span><span class="nx">dsn</span><span class="p">);</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="err">/cfscript&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="err">/cffunction&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Either way, be careful when doing this particularly if the method is being called from multiple application points and one of those could be <em>onSessionEnd()</em>.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2007-09-28T13:19:55+10:00" pubdate data-updated="true">Sep 28<span>th</span>, 2007</time></div>
	<div class="tags">


	<a class='category' href='/categories/coldfusion/'>ColdFusion</a>


</div>
	
		<div class="comments"><a href="/2007/09/28/caveat-when-calling-components-from-onsessionend//page/16/index.html#disqus_thread">Comments</a></div>
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/2007/09/28/jquery-and-swfobject-conflict/">
		
			jQuery and SWFObject Conflict</a>
	</h2>
	<div class="entry-content">
		<p>I experienced some strange behaviour today when building a site which was using jQuery and SWFObject. Our Flash files were loading ok and 99% of the javascript (using jQuery) was working fine.</p>

<p>The problem was found only in IE (sound familiar?) with the following code:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#submitButton&#39;</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
</span></code></pre></td></tr></table></div></figure>


<p>When the &#8216;submitButton&#8217; was clicked, this function was not firing in IE. After some googling I found that there is a slight conflict with jQuery and SWFObject. I tested this and found the problem in jQuery 1.1.x and 1.2.1.</p>

<p><a href="http://blog.deconcept.com/swfobject/forum/discussion/540/jquery-and-swfobject-tips/">I found the fix</a> on the SWFObject forums which is basically using jQuery to load the .swf:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="o">&lt;</span><span class="nx">script</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;text/javascript&quot;</span><span class="o">&gt;</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">so</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SWFObject</span><span class="p">(</span><span class="s2">&quot;movie.swf&quot;</span><span class="p">,</span> <span class="s2">&quot;mymovie&quot;</span><span class="p">,</span> <span class="s2">&quot;400&quot;</span><span class="p">,</span> <span class="s2">&quot;100%&quot;</span><span class="p">,</span> <span class="s2">&quot;8&quot;</span><span class="p">,</span> <span class="s2">&quot;#336699&quot;</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">so</span><span class="p">.</span><span class="nx">addParam</span><span class="p">(</span><span class="s2">&quot;quality&quot;</span><span class="p">,</span> <span class="s2">&quot;low&quot;</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">so</span><span class="p">.</span><span class="nx">addParam</span><span class="p">(</span><span class="s2">&quot;wmode&quot;</span><span class="p">,</span> <span class="s2">&quot;transparent&quot;</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">so</span><span class="p">.</span><span class="nx">addParam</span><span class="p">(</span><span class="s2">&quot;salign&quot;</span><span class="p">,</span> <span class="s2">&quot;t&quot;</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">so</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="s2">&quot;flashcontent&quot;</span><span class="p">);</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'><span class="o">&lt;</span><span class="err">/script&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>All good in all browsers :)</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2007-09-28T11:27:24+10:00" pubdate data-updated="true">Sep 28<span>th</span>, 2007</time></div>
	<div class="tags">


	<a class='category' href='/categories/javascript/'>Javascript</a>


</div>
	
		<div class="comments"><a href="/2007/09/28/jquery-and-swfobject-conflict//page/16/index.html#disqus_thread">Comments</a></div>
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/2007/09/27/creating-a-custom-farcry-login-page/">
		
			Creating a Custom FarCry Login Page</a>
	</h2>
	<div class="entry-content">
		<p>The FarCry security model is really very cool. You can of course setup users within the &#8216;admin&#8217; area and assign those users to groups (and those groups can have different permissions), but you can also authenticate via Active Directory or LDAP etc.</p>

<p>One thing you can also do with ease is secure particular navigation &#8216;nodes&#8217; of the website, thus quickly and easily creating password protected &#8216;member&#8217; areas.</p>

<p>Whenever you secure a navigation branch the user is presented with the default FarCry login screen as seen below:</p>

<p><img src="/images/uploads/2007/09/farcrylogin.jpg" alt="FarCry login" /></p>

<p>Because this is a &#8216;front end&#8217; page (seen by site visitors) you will often want to change the look and feel to mimick your client&#8217;s design for branding purposes. As with a lot of things with FarCry this is a piece of cake!</p>

<p>All you need to do is add your own login screen in /yourproject/customadmin/login/login.cfm</p>

<p>It&#8217;s probably best to copy the original login.cfm from /farcry/core/tags/navajo/login.cfm so all the FarCry &#8216;logic&#8217; is retained, just make all the HTML/CSS changes you need.</p>

<p>Here is an example of just that, a custom &#8216;front end&#8217; login screen:</p>

<p><img src="/images/uploads/2007/09/customlogin.jpg" alt="Custom login" /></p>

<p>The only thing with this is that when a client administrator needs to login to FarCry administration area (or &#8216;Webtop&#8217;) they will also see this &#8216;custom&#8217; template.</p>

<p>If this meets client expectations then you have nothing to worry about, if however you want to have the default FarCry login screen visible when an administrator is logging in to the back-end (while retaining the custom login screen on the front-end) then you need to make this simple change at the top of your custom login.cfm:</p>

<p>/yourproject/customadmin/login/login.cfm</p>

<p>Note that this needs to be at the top of the page (above your custom login code).</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c">&lt;!--</span><span class="o">-</span>
</span><span class='line'>  <span class="nx">If</span> <span class="nx">a</span> <span class="nx">user</span> <span class="nx">is</span> <span class="nx">attempting</span> <span class="nx">to</span> <span class="nx">login</span> <span class="nx">to</span> <span class="nx">the</span> <span class="nx">FarCry</span> <span class="nx">webtop</span><span class="p">,</span> <span class="nx">load</span> <span class="nx">the</span> <span class="k">default</span> <span class="nx">login</span> <span class="nx">screen</span><span class="p">.</span>
</span><span class='line'>  <span class="nx">Otherwise</span> <span class="nx">load</span> <span class="nx">the</span> <span class="nx">custom</span> <span class="s1">&#39;members&#39;</span> <span class="nx">login</span> <span class="nx">screen</span> <span class="k">for</span> <span class="nx">password</span> <span class="kr">protected</span> <span class="nx">site</span> <span class="nx">areas</span><span class="p">.</span>
</span><span class='line'> <span class="o">---&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="nx">cfif</span> <span class="nx">structKeyExists</span><span class="p">(</span><span class="nx">URL</span><span class="p">,</span> <span class="s2">&quot;returnURL&quot;</span><span class="p">)</span> <span class="nx">AND</span> <span class="nx">URL</span><span class="p">.</span><span class="nx">returnURL</span> <span class="nx">CONTAINS</span> <span class="s2">&quot;farcry&quot;</span><span class="o">&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="nx">cfimport</span> <span class="nx">taglib</span><span class="o">=</span><span class="s2">&quot;/farcry/core/tags/navajo&quot;</span> <span class="nx">prefix</span><span class="o">=</span><span class="s2">&quot;nj&quot;</span> <span class="o">/&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="nx">nj</span><span class="o">:</span><span class="nx">Login</span><span class="o">&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="nx">cfabort</span> <span class="o">/&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="err">/cfif&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>You can read a little more about <a href="http://docs.farcrycms.org:8080/confluence/display/FCDEV40/Customise+Login">customising logins here</a>.</p>

<p>This will work in FarCry versions 3 and 4.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2007-09-27T11:08:55+10:00" pubdate data-updated="true">Sep 27<span>th</span>, 2007</time></div>
	<div class="tags">


	<a class='category' href='/categories/coldfusion/'>ColdFusion</a>, <a class='category' href='/categories/farcry/'>Farcry</a>


</div>
	
		<div class="comments"><a href="/2007/09/27/creating-a-custom-farcry-login-page//page/16/index.html#disqus_thread">Comments</a></div>
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/2007/09/27/coldfire-10-released/">
		
			ColdFire 1.0 Released</a>
	</h2>
	<div class="entry-content">
		<p>Yesterday there was some news from <a href="http://www.coldfusionjedi.com/">Ray</a> and <a href="http://www.mischefamily.com/">Nathan Mische</a> regarding the 1.0 release of <a href="http://coldfire.riaforge.org/">ColdFire</a>, Nathan has a great <a href="http://www.mischefamily.com/nathan/index.cfm/2007/9/25/Get-ColdFire">write up here</a>.</p>

<p>From RIAForge:</p>

<blockquote><p>ColdFire is an extension to FireBug. It provides debug information in a FireBug tab as opposed to the bottom of the page. This lets you debug and keep your site layout intact, since ColdFusion&#8217;s built-in debug information can sometimes mess with your site layout.</p>

<p>ColdFire currently supports debugging information for:</p>

<p>General Information<br/>
Templates<br/>
Queries<br/>
CFTRACE<br/>
CFTIMER<br/>
Variables<br/>
Trace</p></blockquote>

<p>To use ColdFire you need <a href="http://www.getfirebug.com/">Firebug</a> for Firefox, for those that aren&#8217;t using Firebug at all&#8230;do yourselves a favour and get it now. It is an AMAZING tool to develop with.</p>

<p>I only just installed ColdFire and already I can see it will be another invaluable tool to use, so check it out.</p>

<p>The only thing for me so far is that I get no &#8216;Variables&#8217; output when developing with FarCry (v4). I&#8217;ll need to keep looking into this one. Have any other FarCry developers run across this?</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2007-09-27T10:13:37+10:00" pubdate data-updated="true">Sep 27<span>th</span>, 2007</time></div>
	<div class="tags">


	<a class='category' href='/categories/coldfusion/'>ColdFusion</a>, <a class='category' href='/categories/farcry/'>Farcry</a>


</div>
	
		<div class="comments"><a href="/2007/09/27/coldfire-10-released//page/16/index.html#disqus_thread">Comments</a></div>
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/2007/09/25/google-analytics-air-app/">
		
			Google Analytics AIR App</a>
	</h2>
	<div class="entry-content">
		<p>An interesting AIR app has been <a href="http://www.aboutnico.be/index.php/google-analytics-air-beta-sign-up/">released in Beta</a> for <a href="http://www.google.com/analytics">Google analytics</a>.</p>

<p>From the author:</p>

<blockquote><p>The Google Analytics Reporting suite is an Adobe AIR application that brings Google Analytics to the desktop. It uses itâ€™s own custom API to interact with Google and nearly implements all features of Analytics.</p></blockquote>

<p>You can even export the data to PDF, XLS (Excel) and XML.</p>

<p>Nice :)</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2007-09-25T12:26:32+10:00" pubdate data-updated="true">Sep 25<span>th</span>, 2007</time></div>
	<div class="tags">


	<a class='category' href='/categories/air/'>AIR</a>


</div>
	
		<div class="comments"><a href="/2007/09/25/google-analytics-air-app//page/16/index.html#disqus_thread">Comments</a></div>
	
</div></article>

<nav id="pagenavi">
    
        <a href="/page/15/" class="prev">Prev</a>
    
    
        <a href="/page/17/" class="next">Next</a>
    
    <div class="center"><a href="/blog/archives">Blog Archives</a></div>
</nav></div>
	<footer id="footer" class="inner">Copyright &copy; 2013

    Michael Sharman

</footer>
	<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->


<script type="text/javascript">
      var disqus_shortname = 'chapter31';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-306772-2']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>



</body>
</html>
